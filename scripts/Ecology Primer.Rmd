---
title: "Primer in Ecology for R"
author: "Daniel Smith"
date: "28/02/2019"
output: html_document
---


## Specify a Food Web Interaction Matrix 

```{r}
Aq = matrix(c(-1, -10, 0, 0, 0.1, 0, -10, 0, 0, 0.1, 0, -10,
              0, 0, 0.1, 0), nrow = 4, byrow = TRUE)
# construct matrix `Aq` 
```

Note that `Aq` matrix indicates a negetive effect of the basal species on itself, large negative effects (-10) of each consumer on its prey, and small posotive eefects of each prey on its consumer.

For the subsequent calculations, it is convenient to find out from the matrix itself how big the matrix is. This can be though of as how many species, _*S*_, are in the web

```{r}
S <- nrow(Aq) # how many rows are int he matrix?
# equates to how many species are in the matrix
```

We need to create a random realisation of this matrix by multiplying each element times a unique random number between 1 and 0. For this matrix that requres 4^2 unique numbers

```{r}
M <- Aq * runif(S^2)
```

Next we need to perform an eigenanalysis on it, retaining eigenvalues

```{r}
eM <- eigen(M)[["values"]]
```

Pimm and Lawton then tested whether the dominant eigne value was greater than 0 (unstable) and of less than 0, then calculating the return time. 

```{r}
deM <- max(Re(eM)) # maximum real number in the eM complex numbers
```

We need to incorporate the stabilising effect of intraspecific negative density dependance

```{r}
intraNDD <- sqrt(sum(diag(M)^2)/S)
```

It might also be important to calculate interaction strength, not including intraspecific interacvtions. Here we set the diagonal interactions to 0, square the remaining elements, find their average, and then take the square root

```{r}
diag(M) <- 0
IS <- sqrt(sum(M^2))/(S * (S - 1))
```

You should also recall that weak interactions in food webs provide stabilising properties. For webs that include omnivory we will calculate the interactions trength of omnivory in the same way we do for other interactions, as the square root of the average of the squared _a_~ij~

We can do this with the following function

```{r}
args(pimmlawton) 
pimmlawton <- function(mat, N = 1, omni.i = NA, omni.j = NA, omega = NULL)
NULL
```

```{r}
set.seed(1)
pimmlawton(Aq)
```


## negative density dependence for basal species 

## jacobian elements 


## qualitative stability 


## compare stability 


